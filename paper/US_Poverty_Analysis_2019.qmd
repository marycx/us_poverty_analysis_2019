---
title: "Understanding the Impact of Mortgage State and Income on Household Poverty Status"
subtitle: "An Analysis of Household Poverty Status in the United States in 2019"
author: 
  - Mary Cheng
thanks: "Code and data are available at: https://github.com/marycx/us_poverty_analysis_2019.git"
date: today
date-format: long
abstract: "This paper examines household poverty status in the United States in 2019 using the 2019 Revised Supplemental Poverty Measure Research Dataset from the United States Census Bureau. Using logistic regression analysis, we investigate the influence of household income level and mortgage state on poverty status. Our findings reveal a higher likelihood of poverty for households' total annual income less than $50000, while all households with incomes exceeding $100000 are not in poverty. Also, renters is more likely to be in poverty compared to property owners. These insights emphasize the need for targeted interventions to address socioeconomic inequalities and promote financial well-being among US households."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(arrow)
library(here)
library(rstanarm)
library(modelsummary)
library(ggplot2)
library(knitr)
library(marginaleffects)
library(plotly)
library(tibble)
library(margins)
library(kableExtra)
```


\newpage
# Introduction
Despite many policies the United States have implemented to mitigate poverty, there has been no real improvement [@Kearney_Harris]. Poverty remains a major issue in the US, affecting millions of people. In 2019, the poverty rate was 10.5%, which was approximately 34.0 million people [@Semega_2022]. Therefore, we want to find out the causes of poverty, in order to reduce it. Multiple research, using the Official Poverty Measure dataset gathered by the United States Census Bureau (USCB), looked at why poverty persists. USCB is an agency of the U.S. Federal Statistical System, responsible for producing data about the American people and economy [@uscb]. Over the years, people have realized that the Official Poverty Measure is flawed in various aspects [@Gesumaria_2015]. Therefore, Supplemental Poverty Measure was developed to address numerous concerns of Official Poverty Measure critics, providing an improved statistical picture of poverty. In this paper, we will analyze why some US household are in poverty in 2019 using the 2019 Revised Supplemental Poverty Measure (SPM) Research dataset from the United States Census Bureau (USCB) [@Bureau_2022]. We build a prediction model for households poverty status using 2019 Revised SPM dataset. This allows us to look at the question whether potential financial factors may influence the poverty status for US households in 2019.

In this paper, a logistic regression model is used to predict the poverty status of households in the United States in 2019, with data from the 2019 Revised Supplemental Poverty Measure Research dataset. Logistic regression is a great choice since it is used to predict binary outcomes, such as poverty status (in poverty or not in poverty). Our analysis focuses on estimating the likelihood of household being in poverty, based on various financial factors captured in the SPM dataset. I selected 17 data features for analysis. After some data cleaning, I summarized 17 features into 2 variables: 1) mortgage state and 2) household annual total income after tax, plus government benefits and minus expenses. 

The logistic regression model shows that in the US in 2019, households with an annual total income less than $50000 are almost all in poverty. For households earning $50000 to $100000, the majority is not in poverty, yet a notable amount of them are still in poverty. For households earning above $100000, all of them are not in poverty. Additionally, renters are more likely to be in poverty compared to owners with or without mortgage.

The remainder of this paper is structured into different sections. @sec-data demonstrates the data used for our report and includes some tables and graphs to illustrate the different groups of people in our data. @sec-model builds the model and discusses its justification and explanation. @sec-result highlights the results of the predictions using tables and graphs. @sec-discussion contains discussions that conducted based on the findings, which addresses the poverty status results based on mortgage states and income levels. Statistical programming language R [@citeR] is used in this report, with packages `tidyverse` [@citeTidyverse], `here` [@citeHere], `rstanarm` [@citeRstanarm], `modelsummary` [@citeModleSummary], `ggplot2` [@citeGgplot2], `knitr` [@citeKnitr], `marginaleffects` [@citeMarginalEffects], `plotly` [@citePlotly], `tibble` [@citeTibble], `margins` [@citeMargins], `testthat` [@citetestthat] and `kableExtra` [@citeKableExtra].

## Estimand
The estimand in this paper is the number of households who are in poverty in reality. However, it is difficult to measure the exact number of households who are in poverty since there are millions of people in the United States and not all of them will be assessed due to various difficulties. For example, due to regional issues, some people who live in rural areas might not be included in the survey. Therefore, in this paper, we attempt to estimate the estimand using a logistic regression model which is fitted using sample dataset from the 2019 Revised Supplemental Poverty Measure Research Data from USCS.

# Data {#sec-data}

## Data Source
This report uses the 2019 Revised Supplemental Poverty Measure (SPM) Research dataset provided by the United States Census Bureau as our main source of data. The Census Bureau provides information about the people and economy of the United States, with a goal to support economic growth, enhance scientific knowledge, and assist in making informed decisions. The official poverty measure has been criticized due to its multiple limitations [@sgp2019]. For example, it does not consider benefits from most of the largest programs that aid the low-income population. For instance, it uses money income before taxes, so it does not measure the income available for individuals to spend, which for most people is after-tax income. So, the Supplemental Poverty Measure (SPM) was developed. It is similar to the official poverty measure, but it takes more aspects into account. It considers expenditures on essentials like food, clothing, shelter, and utilities, plus a bit more for additional expenses. The resources assessed include disposable income, accounting for taxes and some non-cash benefits, available to cover these needs [@Gesumaria_2015]. In 2019, the dataset contained a total of 157,959 entries.


## Features
The original SPM 2019 dataset, which shows in @tbl-raw in Appendix @sec-data-details, contains 157959 data entries and many variables. Since it is difficult to observe such a large dataset, this report will only explore and analyze through several data features. We first chose these 17 variables: h_seq, spm_poor, spm_tenmortstatus, spm_totval, spm_snapsub, spm_caphousesub, spm_schlunch, spm_engval, spm_wicval, spm_fedtax, spm_eitc, spm_actc, spm_fica, spm_sttax, spm_childsuppd, spm_capwkccxpns, and spm_medxpns. Their explanation are in @tbl-feature. We can use those features (other than h_seq, spm_poor, spm_tenmortstatus) to calculate the income after tax, by adding all the subsidies and benefits and substracting all the expenses (just like how the SPM does it [@sgp2019]). This way the income is able to reflect the financial situation on households more accurately.


```{r}
#| include: false
#| warning: false
#| message: false

# read in raw data
raw_poverty_data <-  read_csv(here::here("data/raw_data/raw_poverty_data.csv"))
```


## Data Measurement
The data was mainly collected by surveys conducted by USCB. Portions of SPM resources, such as values of taxes and some non-cash benefits, were not asked of respondents and were estimated using models. However, the estimated amounts are not perfect. For example, they found that the estimated total benefits from both the Earned Income Tax Credit and the child tax credit are lower than those found when examining federal income tax returns [@spm].

The unit of measurement for numerical data are in US Dollars. For other data, they are categorical features with no units.

### Data Consideration
The data are estimates based on a sample of the population, so it cannot represent the whole population of the United States. This creates margins of error. Also, since the SPM poverty estimates are from household survey data, the data might be affected by issues such as under-reporting, over-reporting, or making up data. Some people might not remember the exact value of some data, for example, not all people have or know that they receive income from government benefit programs, so they might be reporting it inaccurately. In addition, some SPM resources, such as taxes and non-cash benefits, are estimated using models. The models use administrative data, but the estimated amounts are not perfect.


## Methodology
The original dataset includes duplicated responses from the same household. As the report is analyzing the household poverty status, I will eliminate duplicate entries, using the variable "h_seq" which is an unique household identifier, to ensure data accuracy and consistency.

First, a new column "income after tax" is created by summing up all incomes, credits, and benefits and subtracting all expenses. Then the dataset is cleaned by renaming of column headers, defining column classes, grouping the income variable into different income levels (here the assumed facts are that the income unit is in USD and 'k' stands for thousand, eg. 5k = 5000), and replacing numerical values in the table with their corresponding descriptions from the data dictionary to improve the readability. 

After cleaning, 62990 rows of data with 3 data features remain. @tbl-clean-data shows a preview of the cleaned dataset.


```{r}
#| include: false
#| warning: false
#| message: false

# read in cleaned data
poverty2019 <-  read_parquet(here::here("data/analysis_data/cleaned_poverty_data.parquet"))

poverty2019 <-
  poverty2019 |>
  mutate(
    poverty_status = as_factor(poverty_status),
    mortgage_state= factor(
      mortgage_state,
      levels = c(
      "Owner with Mortgage",
      "Owner without Mortgage",
      "Renter")
    ),
    income = factor(
      income,
      levels = c(
      "below 5k",
      "5k-50k",
      "50k-100k",
      "100k-150k",
      "150k-200k",
      "200k-250k",
      "above 250k")
    )
  ) |>
  select(poverty_status, mortgage_state, income)
```

```{r fig.pos="h"}
#| label: tbl-clean-data
#| tbl-cap: "Preview of the cleaned 2019 US Supplemental Poverty Measure dataset"
#| message: false
#| echo: false

colnames(poverty2019) <- c("poverty status", "mortgage state", "income level")

poverty2019[1:5, 1:3] |>
  kable()
```

@tbl-summary is a summary of the cleaned data, showing detailed statistics about the dataset. As we can see from the table, there are more households which are not in poverty. Respondents cover a wide range of income levels, with "5k-50k" and "50k-100k" being more heavily represented. Also, the mortgage states of the households vary, each of the three mortgage states being fairly evenly represented.

```{r fig.pos="h"}
#| label: tbl-summary
#| tbl-cap: "Statistics summary of the cleaned 2019 US Supplemental Poverty Measure dataset"
#| message: false
#| echo: false

poverty2019 |>
  summary() |>
  kable(align = "c") %>%
  kable_styling(font_size = 12)
```


## Data Visualization
@tbl-mortgage illustrates the relationship between mortgage state and poverty status of households. It can be seen that renters are the highest proportion of households experiencing poverty, followed by owners without mortgages, and finally owners with mortgages. Conversely, for households who are not in poverty, owners with mortgages represent the largest segment, followed by owners without mortgages, and then renters. In addition, it can be observed that overall a larger proportion of households are not experiencing poverty. Despite variations in poverty rates across different mortgage states, the cumulative data shows economic stability among the majority of households in the United States in 2019.
```{r}
#| label: tbl-mortgage
#| tbl-cap: "The distribution of poverty status by mortgage state"
#| message: false
#| echo: false
#| warning: false
colnames(poverty2019) <- c("poverty_status", "mortgage_state", "income")

# calculate poverty ratio for renter, Owner with Mortgage, and Owner without Mortgage
rent_p <- sum(poverty2019$mortgage_state == "Renter" & poverty2019$poverty_status == "In poverty")
rent_np <- sum(poverty2019$mortgage_state == "Renter" & poverty2019$poverty_status == "Not in poverty")

mort_p <- sum(poverty2019$mortgage_state == "Owner with Mortgage" & poverty2019$poverty_status == "In poverty")
mort_np <- sum(poverty2019$mortgage_state == "Owner with Mortgage" & poverty2019$poverty_status == "Not in poverty")

nomort_p <- sum(poverty2019$mortgage_state == "Owner without Mortgage" & poverty2019$poverty_status == "In poverty")
nomort_np <- sum(poverty2019$mortgage_state == "Owner without Mortgage" & poverty2019$poverty_status == "Not in poverty")

# show data feature
mortgage <- tibble(
  Household_type = c("Renters", "Owners with Mortgage", "Owners without Mortgage"),
  In_poverty_percentage = c(round(rent_p/(rent_p+rent_np)*100, digits = 2), round(mort_p/(mort_p+mort_np)*100, digits = 2), round(nomort_p/(nomort_p+nomort_np)*100, digits = 2)),
  Not_in_poverty_percentage = c(round(rent_np/(rent_p+rent_np)*100, digits = 2), round(mort_np/(mort_p+mort_np)*100, digits = 2), round(nomort_np/(nomort_p+nomort_np)*100, digits = 2))
)

kable(mortgage, 
      align = c("c", "c", "c")  # Center alignment for all columns
)
```


```{r fig.show='hide'}
#| label: fig-mortgage
#| fig-cap: The distribution of poverty status by mortgage state
#| echo: false
#| warning: false
#| message: false
#| 

colnames(poverty2019) <- c("poverty_status", "mortgage_state", "income")
poverty2019 |>
  ggplot(aes(x = mortgage_state, fill = poverty_status)) +
  geom_bar(position = "dodge", width = 0.5) +
  theme_minimal() +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Mortgage state",
    y = "Number of households",
    fill = "Poverty Status"
  )
```



@tbl-income shows the relationship between household annual total income and their poverty status. We can see that among households earning more than 100k annually, no household is in poverty. For household with income between 50k to 100k, almost all of them are not in poverty with only a very small number of households in poverty. Within the income range of 5k-50k, the majority of households are not in poverty, but there are some families in poverty. However, for households earning below 5k annually, all of them are in poverty. This indicates a strong positive correlation between higher income levels and financial stability.


```{r}
#| label: tbl-income
#| tbl-cap: "The distribution of poverty status by income level"
#| message: false
#| echo: false
#| warning: false

# calculate poverty ratio for different income levels
five_fifty_p <- sum(poverty2019$income == "5k-50k" & poverty2019$poverty_status == "In poverty")
five_fifty_np <- sum(poverty2019$income == "5k-50k" & poverty2019$poverty_status == "Not in poverty")

belowfive_p <- sum(poverty2019$income == "below 5k" & poverty2019$poverty_status == "In poverty")
belowfive_np <- sum(poverty2019$income == "below 5k" & poverty2019$poverty_status == "Not in poverty")

fifty_hund_p <- sum(poverty2019$income == "50k-100k" & poverty2019$poverty_status == "In poverty")
fifty_hund_np <- sum(poverty2019$income == "50k-100k" & poverty2019$poverty_status == "Not in poverty")

hund_fifty_p <- sum(poverty2019$income == "100k-150k" & poverty2019$poverty_status == "In poverty")
hund_fifty_np <- sum(poverty2019$income == "100k-150k" & poverty2019$poverty_status == "Not in poverty")

fifty_twohund_p <- sum(poverty2019$income == "150k-200k" & poverty2019$poverty_status == "In poverty")
fifty_twohund_np <- sum(poverty2019$income == "150k-200k" & poverty2019$poverty_status == "Not in poverty")

twohund_fifty_p <- sum(poverty2019$income == "200k-250k" & poverty2019$poverty_status == "In poverty")
twohund_fifty_np <- sum(poverty2019$income == "200k-250k" & poverty2019$poverty_status == "Not in poverty")

above_p <- sum(poverty2019$income == "above 250k" & poverty2019$poverty_status == "In poverty")
above_np <- sum(poverty2019$income == "above 250k" & poverty2019$poverty_status == "Not in poverty")

# show data feature
income_level <- tibble(
  Household_type = c("below 5k","5k-50k","50k-100k","100k-150k","150k-200k","200k-250k","above 250k"),
  In_poverty_percentage = c(round(belowfive_p/(belowfive_p+belowfive_np)*100, digits = 2), round(five_fifty_p/(five_fifty_p+five_fifty_np)*100, digits = 2), round(fifty_hund_p/(fifty_hund_p+fifty_hund_np)*100, digits = 2), round(hund_fifty_p/(hund_fifty_p+hund_fifty_np)*100, digits = 2), round(fifty_twohund_p/(fifty_twohund_p+fifty_twohund_np)*100, digits = 2), round(twohund_fifty_p/(twohund_fifty_p+twohund_fifty_np)*100, digits = 2), round(above_p/(above_p+above_np)*100, digits = 2)),
  Not_in_poverty_percentage = c(round(belowfive_np/(belowfive_p+belowfive_np)*100, digits = 2), round(five_fifty_np/(five_fifty_p+five_fifty_np)*100, digits = 2), round(fifty_hund_np/(fifty_hund_p+fifty_hund_np)*100, digits = 2), round(hund_fifty_np/(hund_fifty_p+hund_fifty_np)*100, digits = 2), round(fifty_twohund_np/(fifty_twohund_p+fifty_twohund_np)*100, digits = 2), round(twohund_fifty_np/(twohund_fifty_p+twohund_fifty_np)*100, digits = 2), round(above_np/(above_p+above_np)*100, digits = 2))
)

kable(income_level, 
      align = c("c", "c", "c")  # Center alignment for all columns
)
```



```{r fig.show='hide'}
#| label: fig-income
#| fig-cap: The distribution of poverty status by income level
#| echo: false
#| warning: false
#| message: false


poverty2019 |>
  ggplot(aes(x = income, fill = poverty_status)) +
  geom_bar(position = position_dodge2(width = 0.5, preserve = "single")) +
  coord_flip() +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Income level",
    y = "Number of households",
    fill = "Poverty status"
  )
```


# Model {#sec-model}
In our analysis, we utilized a Bayesian logistic regression model to examine the relationship between poverty status and two financial factors, mortgage status and income of the household. Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up
The model is formulated as follows:
\begin{align} 
y_i|\pi_i &\sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &= \alpha + \beta_1 \times \mbox{mortgage}_i + \beta_2 \times \mbox{income}_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta_1 &\sim \mbox{Normal}(0, 2.5) \\
\beta_2 &\sim \mbox{Normal}(0, 2.5)
\end{align}

In this model, $y_i$ represents the binary outcome variable indicating whether a household is in poverty (as opposed to not in poverty). The probability of being in poverty ($\pi_i$) is modeled using a logistic link function (\text{logit}($\pi_i$)), which is a linear combination of the intercept ($\alpha$) and the coefficients ($\beta_1$, $\beta_2$) corresponding to the predictor variables, mortgage state and income level, respectively. These predictor variables are denoted as income_i and mortgage_state_i, where $i$ indexes the individual households in the dataset.

The intercept ($\alpha$) and coefficients ($\beta_1$, $\beta_2$) are assigned informative prior distributions to regularize the model. Specifically, we assume a normal distribution with a mean of 0 and a standard deviation of 2.5 for each parameter.

We chose this modeling approach for several reasons. Firstly, logistic regression is ideal for binary outcome variables, making it appropriate for analyzing poverty status. Also, Bayesian methods enable us to integrate prior knowledge and uncertainty into the analysis, resulting in more reliable estimates of the model parameters. While alternative modeling approaches like linear regression were considered, we selected Bayesian logistic regression due to the binary nature of our outcome variable: poverty status.

We use the `rstanarm` package [@citeRstanarm] in R [@citeR] to run the model. Default priors from `rstanarm` is used. Rstanarm employs Markov chain Monte Carlo (MCMC) techniques to estimate the posterior distribution of the parameters. To avoid excessive runtime, 1000 data entries are randomly sampled to fit the model with random seed 215. Model diagnostics, including convergence checks and posterior summaries, are available in the supplementary materials (see Appendix @sec-model-details).


## Model justification
Regarding the relationship between mortgage state and poverty state, we anticipate that both owners without mortgages and owners with mortgages are less likely to experience poverty. Owners without mortgages typically indicate financial stability, as they have already paid off their homes and can allocate financial resources toward household necessities, other than paying back the mortgage / rent. Also, without monthly mortgage or rent payments, their financial burden is reduced, further decreasing the likelihood of poverty. Similarly, owners with mortgages demonstrate financial responsibility by securing loans from banks. The approval of these loans suggests that the bank is confident in owner's ability to manage repayments, indicating a lower possibility of poverty. On the other hand, renters are more likely to experience poverty due to their lack of property ownership and the hidden implication that they do not earn enough to purchase their own property. Renters typically have fewer savings and may earn insufficient salaries to cover rental and essential expenses. Consequently, the combination of rental payments and other financial obligations increases their vulnerability to poverty.

In terms of income levels, we expect a positive relationship between household's income level and their poverty status. This expectation arises from common sense that higher income typically reduces the likelihood of experiencing poverty. If a family is earning a lot of money, then naturally it would not be in poverty. Households that are earning less than 5k annually in the United States obviously have a larger chance in being in poverty due to the high cost of living. Their income probably barely covers or cannot cover for essential expenses such as housing, transportation, or food.


# Results {#sec-result}
Our results are summarized in @tbl-modelresults. Our results generally matches our expectation. To avoid multicollinearity, the model excludes one variable from each category: mortgage state "Owner with mortgage" and income level "100k-150k". The intercept represents the estimated log-odds of being in poverty when all other predictors are held constant at their reference levels. In this case, the estimated log-odds of being in poverty for people who are owner with mortgage and their total household income level to be 100k-150k annually is −6.896. 

The possibility of households with income level below 5k being in poverty is large. The estimated coefficient of 17.352 suggests that, holding all other variables constant, households with income less than 5k are estimated to have a 17.352 unit increase in the log-odds of being in poverty compared to the reference group. Households with income level at "5k-50k" and "50k-100k" on average are also more likely to be in poverty compared to the reference group, with the estimated coefficient to be 5.346 and 1.502 respectively.

The mortgage status of individuals also influences their poverty status. As expected, renters exhibit a higher likelihood of experiencing poverty, as shown by the estimated coefficient of 0.645. However, it's important to note that while the coefficient is positive compared to the reference group, its magnitude is relatively small, suggesting a moderate rather than a substantial difference.

@fig-modelresults1 (see @sec-credibility-interval) shows range of coefficient estimates of our model within the 90% probability. Due to the fact that the credibility interval for mortgage "Renter" and "Owners without mortgage" is quite small, it is hard to observe the trend of the 90% credibility intervals of these two variables. Therefore we created @fig-modelresults2 with the x axis limited from -5 to 5. 

Combining @fig-modelresults1 and @fig-modelresults2, we observe statistical significance for the coefficient estimates for household with income below 5k, household income between 5k to 50k, renters, and the intercept, household which owns a property with mortgage and has a income level between 100k to 150k. The estimates are significant because their credibility intervals do not cross 0. The value for the estimates are in log-odds, indicating that if the coefficient is positive, the household is in poverty, if negative, the household is not in poverty.


## Model Validation
For posterior predictive checks, in @fig-post_dist, the great fit of the posterior distribution from our logistic regression model with actual poverty data suggests accurate capture of poverty status patterns. This indicates the accuracy of our model's poverty status prediction to the 2019 SPM data. Also, @fig-post_prior compares the posterior to the prior, which shows some parameter changes such as "below 5k" and "5k-50k", as well as the intercept (people who are owners with mortgage and earn 100-150k). The discrepancy for the parameter suggest that our prior may not be very accurate in regards to these specific aspects.

The trace plots in @fig-trace1 and @fig-trace2 do not suggest anything out of the ordinary. Also, with the Rhat plot (@fig-rhat), we can observe that everything is close to 1, and no more than 1.05, which shows the great convergence of Markov chain Monte Carlo for our model.

More explanation can be found in Appendix @sec-model-details.
```{r fig.pos="h"}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: tbl-modelresults
#| tbl-cap: "Explanatory model Poverty Prediction (n = 1000)"

poverty_prediction_model <-
  readRDS(file = here::here("models/poverty_prediction_model.rds"))

modelsummary(
  list(
    "In poverty" = poverty_prediction_model
  ),
  statistic = "mad"
  )
```

# Discussion {#sec-discussion}

## Relationship betwen Mortgage State and Poverty Status
In the USA in 2019, housing costs accounted for more than 30% of household expenditure, making mortgage status a critical factor in determining a family's risk of falling into poverty [@Statistics_2020]. The percentage of individuals below the poverty threshold, adjusted for housing costs are: $29,080 for a family of four with a mortgage, $24,413 for a family of four without a mortgage, and $29,194 for a family of four renting [@Khattar_Pathak_Schweitzer_Khan_McManus_Jones_Benson_Kelly_2023]. From this, we can see that families without mortgages experienced the lowest housing costs, leaving more funds available for other essentials. In contrast, families with mortgages may face expensive monthly payments, especially if they have chosen a floating interest rate, making them vulnerable to rising interest rates. Renters also experience challenges when the rent increases. So they either have to accept higher housing costs or waste time and energy to find new homes. This supports my model result that renters are more likely to be in poverty.

Also, low-income households have a harder time to access lower mortgage rates and reduce debt burdens through refinancing. Households with low to moderate incomes were less able to take advantage of lower mortgage rates and relieve their debt burdens through refinancing during the period of exceptionally low rates: only 24% of mortgages in low-income regions underwent refinancing, in contrast to the 42% in high-income areas [@mortgage]. Therefore, it is generally harder for low-income households to repay their mortgage than higher income households.

These problems with housing make it more likely for families which are already in poverty, to become poorer. So it is important to make housing more affordable for people, in order to help people out of poverty.

## Relationship betwen Income and Poverty Status
The relationship between a household's income after tax and its poverty status is characterized by a negative correlation, wherein higher income corresponds to a reduced probability of experiencing poverty. This correlation shows the role of financial resources in mitigating economic hardship and facilitating socio-economic well-being. However, in the United States, the cost of living is notably high, low-income households often struggle to meet basic needs, resulting in an unending cycle of poverty. About half of lower-income parents (52%) say they have not had enough money for food or their rent or mortgage. Some 45% of employed parents with lower incomes say they would be very worried about losing pay if they needed to take a day or two off from work to deal with a sick child or because of child care issues [@Braga_2022]. This type of delimma for low-income households makes them harder to pull themselves out of poverty.

In 2019, the poverty guideline for a one-person household was set at $12,490 annually [@ASPE]. So, it is evident that families earning less than $5,000 are definitely living below the poverty line. This is supported by my model result. Conversely, individuals with high incomes are less likely to experience poverty, as their financial resources enable them to comfortably cover living expenses. They will be able to have savings accumulation, further consolidating their financial security and contributing to wealth accumulation over time.


## US Government Programs to Help
For household in poverty, escaping poverty is tough, but the US government and communities are stepping up to help. For example, single parents often struggle with low incomes. But they can get help from government programs such as the Supplemental Nutrition Assistance Program (SNAP) [@snap], commonly known as food stamps, which provides eligible low-income individuals and families with funds to purchase nutritious food. They can also receive child support payments to help cover expenses for their kids. Families with low incomes and lots of kids can also get help. Programs like the Child Tax Credit (CTC) [@ctc], which provides tax credits to eligible families with qualifying children. Other programs, like housing assistance and Medicaid, provide support with things like affordable housing and healthcare. These programs are all aimed at helping families in need to get back on their feet and improve their poverty situation.

## Limitations

### Measurement of Medical Subsidies
Even the SPM accounts for expenses for healthcare and insurance by subtracting them from family resources, it does not directly value health insurance provided as a resource [@spm]. The treatment of medical expenses does not take account of all the economic effects of subsidized medical care, for example, there are families who purchase a less expensive insurance plan and decide to give up some health care. Moreover, some of the largest non-cash benefits programs (Medicare, Medicaid, etc.) are not explicitly taken into account when determining poverty status. 


### Lump sum nature of tax credit
In the SPM, taxes paid and tax credits in the year that are earned are include [@spm]d. But typically the credit would not appear in the family income until the next year. Also, tax credits are given as a lump sum, but poverty is a something that might happen anytime in the year. For example, a family may experience poverty because someone lost a job and cannot find another, so the family is in poverty. The tax credit may or may not provide relief depending on the timing in the year and the severity of expenses faced by the family throughout the year. So it is not very accurate that the SPM examine resources in a full calendar year compared with a threshold based on the calendar year. The family might have experienced 11 months of poverty before they got their tax credits in the 12th month.

## Future Steps
Future research should focus on gathering more inclusive and representative data by increasing the volume of data entries and mitigating bias in data collection. Beyond simply collecting data about household financial data, researchers should investigate more government benefits and expenses that are imposed on households. By investigating those benefits and expenses, researchers can arrive at conclusions if the current government poverty policies are effective for household in poverty. It is important to ensure that households in poverty have access to the necessary resources and support by the US government. This makes sure that the research not only analyzes the situation, but also contributes to actionable improvements for those affected.

\newpage

\appendix

# Appendix {-}

# Data {#sec-data-details}
## Raw data
@tbl-raw shows the preview of the raw 2019 US Supplemental Poverty Measure dataset.
```{r fig.pos="h"}
#| label: tbl-raw
#| tbl-cap: "Preview of the raw 2019 US Supplemental Poverty Measure dataset"
#| message: false
#| echo: false

raw_poverty_data[1:5, 1:6] |>
  kable()
raw_poverty_data[1:5, 7:13] |>
  kable()
raw_poverty_data[1:5, 13:17] |>
  kable()
```

## Data feature
@tbl-feature shows the selected features of the 2019 US Supplemental Poverty Measure dataset.
```{r fig.pos="h"}
#| label: tbl-feature
#| tbl-cap: "Selected feature of the 2019 US Supplemental Poverty Measure dataset"
#| message: false
#| echo: false
#| warning: false

# show data feature
feature <- tibble(
  Data_feature = c("h_seq", "spm_poor", "spm_tenmortstatus", "spm_totval", "spm_snapsub", "spm_caphousesub", "spm_schlunch", "spm_engval", "spm_wicval", "spm_fedtax", "spm_eitc", "spm_actc", "spm_fica", "spm_sttax", "spm_childsuppd", "spm_capwkccxpns", "spm_medxpns"),
  Data_definition = c("Household sequence number, unique identifier for each household.", "the poverty status: 1 representing 'in poverty' and 0 representing 'not in poverty'.", "household's tenure/mortgage status: 1 representing 'owner with Mortgage', 2 representing 'owner without Mortgage or rent-free', and 3 representing 'renter'.", "household's cash income, unit in USD.", "Supplemental Nutrition Assistance Program (SNAP) subsidy, unit in USD.", "capped housing subsidy, unit in USD.", "school lunch subsidy, unit in USD.", "energy subsidy, unit in USD.", "Women, Infants, and Children subsidy, unit in USD.", "Federal tax, unit in USD.", "Federal Earned Income Tax Credit, unit in USD.", "Additional Child Tax Credit, unit in USD.", "Federal Insurance Contributions Act and federal retirement contribution, unit in USD.", "state tax, unit in USD.", "child support paid, unit in USD.", "capped work and child care expense, unit in USD.", "Medical Out-Of-Pocket (MOOP) and Medicare Part B subsidy, unit in USD.")
)
kable(feature, "latex") %>%
  column_spec(2, width = "30em")
```
# Model details {#sec-model-details}

## Posterior predictive check
In @fig-post_dist, we implement a posterior distribution. This compares the poverty status of people in reality with the prediction results from the posterior distribution from our logistic regression model. It can be seen that the posterior distribution fits well with the actual data. It suggests that the posterior is able to generate simulated data that closely resembles the actual data [@bayes_post], because the model accurately captures the observed data patterns. This is good because it indicates that our logistic regression model is a good representation of the actual poverty status in the 2019 poverty data from United States Census Bureau.

```{r}
#| label: fig-post_dist
#| fig-cap: Posterior distribution for logistic regression model 
#| echo: false
#| warning: false
#| message: false
#| 

pp_check(poverty_prediction_model) +
  theme(legend.position = "bottom")
```

@fig-post_prior compares the posterior with the prior. This compares the prior distribution of parameters with the posterior distribution of parameters in our logistic regression model. We can see that half of the model parameters do not change after data are taken into account, while some parameters shift slightly. This shows that the observed data partially matches with our initial belief and expectation about the poverty status of people in the United States in 2019. We can see that for people with income level at "below 5k" and "5k-50k" and "Renters", the posterior distributions shift from their prior after we input observed data; their distribution not crossing 0 at all. This is suggesting that the observed data for "below 5k" and "5k-50k" strongly contradict our initial belief. So the majority of people in US who earns less than a total amount of 50k per household annually was in poverty in 2019. Also, the intercept (people who are owners with mortgage and earn 100-150k) shifts to the left; its distribution not crossing 0. This indicates that the actual observation does not match with our prior belief. People in this category was less likely to be in poverty state in 2019 United States.

```{r}
#| label: fig-post_prior
#| fig-cap: Comparing the posterior with the prior 
#| echo: false
#| warning: false
#| message: false

#### Read data ####
analysis_data <- read_parquet(here::here("data/analysis_data/cleaned_poverty_data.parquet"))

# Convert variables to factors
analysis_data$marital_status <- factor(analysis_data$mortgage_state)
analysis_data$income <- factor(analysis_data$income)

# Create poverty_status variable in binary form
analysis_data$poverty_status <- ifelse(analysis_data$poverty_status == "In poverty", 1, 0)

# Model 1 for n = 1000
set.seed(215)

poverty_data_reduced <- 
  analysis_data |> 
  slice_sample(n = 1000)

posterior_vs_prior(poverty_prediction_model, size = 0.1) +
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(axis.text.x=element_text(hjust=1, vjust=0.5),
        text=element_text(size=8)) +
  guides(color = guide_legend(ncol = 4))+
  coord_flip()
```

## Markov chain Monte Carlo Convergence Check

@fig-trace1 and @fig-trace2 are the trace plots of the model. It tells us if there is existence of signs that the our model runs into issues. We observe lines in all the trace plots are horizontal and oscillating, and have overlaps between the chains. This suggests that there is nothing strange in this trace plot.

@fig-rhat is the Rhat plot of the model. It compares the variability within each chain to the variability between chains in MCMC. We can observe that our Rhat plot are all close to 1, and no more than 1.05. This is a good sign because it suggests that the MCMC algorithm has reached convergence for our model. 


```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-trace1
#| fig-cap: "Trace plot of intercept and marital status"
#| fig-subcap: ["Trace plot of Intercept", "Trace plot of Owner without Mortgage", "Trace plot of Renter"]
#| layout-ncol: 2

plot(poverty_prediction_model, "trace", "(Intercept)")
plot(poverty_prediction_model, "trace", "mortgage_stateOwner without Mortgage")
plot(poverty_prediction_model, "trace", "mortgage_stateRenter")
```

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-trace2
#| fig-cap: "Trace plot of income"
#| fig-subcap: ["Trace plot of income 5k-50k", "Trace plot of income 150k-200k", "Trace plot of income 200k-250k", "Trace plot of income 50k-100k", "Trace plot of income above 250k", "Trace plot of income below 5k"]
#| layout-ncol: 2

plot(poverty_prediction_model, "trace", "income5k-50k")
plot(poverty_prediction_model, "trace", "income150k-200k")
plot(poverty_prediction_model, "trace", "income200k-250k")
plot(poverty_prediction_model, "trace", "income50k-100k")
plot(poverty_prediction_model, "trace", "incomeabove 250k")
plot(poverty_prediction_model, "trace", "incomebelow 5k")
```


```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-rhat
#| fig-cap: "Rhat plot"

plot(poverty_prediction_model, "rhat")
```

## 90% Credibility Interval {#sec-credibility-interval}
@fig-modelresults1 and @fig-modelresults2 are 90% credibility interval plots.
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-modelresults1
#| fig-cap: "Credible intervals for predictors of positive poverty status"

modelplot(poverty_prediction_model, conf_level = 0.90, size = 0.2) +
  labs(x = "90% credibility interval") +
  theme(axis.text.y = element_text(size = 6))
```


```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-modelresults2
#| fig-cap: "Credible intervals for predictors of positive poverty status with x_axis limits"

# Create the model plot
model_plot <- modelplot(poverty_prediction_model, conf_level = 0.90, size = 0.2)

# Modify the x-axis limits
model_plot + xlim(-5, 5) +  # Adjust the limits as needed
  labs(x = "90% Credibility Interval") +
  theme(axis.text.y = element_text(size = 6))
```


\newpage


# References


